# TSO500 variant annotation and filtration pipeline

This Bash script automates VCF processing from hg19/GRCh37, including LiftOver, VEP and OncoKB annotation, and the generation of a final table filtered by specific transcripts.

## üöÄ Overview of the Workflow

The script iterates through all compressed VCF files (`.vcf.gz`) located in the `./OriginalVcf` directory and performs the following major steps for each sample:

* **Filtering:** Keeps only variants marked as `PASS`.
* **LiftOver:** Converts genomic coordinates from **hg19** to **hg38**.
* **VEP Annotation:** Adds comprehensive functional and clinical annotations.
* **OncoKB Annotation:** Incorporates therapeutically relevant annotations.
* **Table Generation:** Converts the final annotated VCF into a readable CSV table.
* **Summary:** Tracks variant counts at each stage. Usefull while development to see is variants are missed in the previous steps.

## üõ†Ô∏è Prerequisites and Dependencies

This pipeline relies heavily on containerization and specific tools. Ensure you have the following installed and configured:

1.  **Apptainer/Singularity:** Used to run tools like `bcftools` and GATK in containers.
2.  **GATK (v4.6.0.0 or later):** Used for the LiftOver step (run via Apptainer).
3.  **VEP (Variant Effect Predictor):** Installed locally with necessary plugins (SpliceAI, REVEL) and custom databases (ClinVar, CIViC, CancerHotspots).
4.  **Custom Python Scripts:**
    * `oncoKB-API.py`: For communicating with the OncoKB API and annotating the VCF.
    * `vcf2table.py`: For parsing the final VCF and generating a CSV table, using a transcript list (`TSO500_transcripts_list.txt`).
5.  **Reference Files:**
    * **Chain File:** `hg19ToHg38.over.chain` for LiftOver.
    * **Reference Genome:** `hg38.fa` (FASTA format).

## üìÇ Directory Structure

The script is configured to use the following structure. It will automatically create the necessary output directories:

| Directory | Purpose |
| :--- | :--- |
| `./OriginalVcf` | **Input directory.** Contains the initial VCF files (`*.vcf.gz`). |
| `./FilteredVcf` | VCF files after filtering for `PASS` variants. |
| `./LiftOverVcf` | VCF files with coordinates lifted from hg19 to hg38. |
| `./LiftOverVcf/Rejected` | VCF files containing variants that failed the LiftOver step. |
| `./AnnotatedVcf` | VCF files after comprehensive VEP annotation. |
| `./OncoKB_VCF` | Final VCF files after OncoKB clinical annotation. |
| `./Table` | Final output CSV tables generated by `vcf2table.py`. |
| `./Stats` | Directory for variant count statistics, resulting in `variant_counts.txt`. |

> **Note on Reference Files Source:**
> * **Chain File (`hg19ToHg38.over.chain`):** Sourced from UCSC.
    >    **Download URL:** `https://hgdownload.soe.ucsc.edu/goldenPath/hg19/liftOver/hg19ToHg38.over.chain.gz`
> * **Reference Genome (`hg38.fa`):** The GRCh38 reference genome FASTA used in this pipeline was sourced from NCBI and corresponds to the **GRCh38 analysis set** (with alternate contigs masked and the decoy sequence included).
    >    **Download URL:** `https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/001/405/GCF_000001405.40_GRCh38.p14/GRCh38_major_release_seqs_for_alignment_pipelines/GCA_000001405.15_GRCh38_no_alt_plus_hs38d1_analysis_set.fna.gz`

‚ùå ***Mani, can you please check I am taking the right genome reference in the liftover and annotation.***

## ‚öôÔ∏è Running the Pipeline

### 1. Setup

* Place your input VCF files (named `D21_11111_22222_Breast_33333_S1.dragen.concat_snv_sv.vcfz`) into the `./OriginalVcf` directory.
* Ensure the required chain file and reference FASTA are correctly specified by the `CHAIN` and `REF` variables.
* Verify the paths to VEP, its caches, plugins, and custom databases are correct.
* Ensure `oncoKB-API.py` and `vcf2table.py` are in the same directory as the pipeline script.
* The pipeline relies on several Python libraries, executed via the scripts `oncoKB-API.py` and `vcf2table.py`.

* All necessary packages and their exact versions are listed in the provided `requirements.txt` file.
* **Essential Libraries:** At minimum, the scripts require `cyvcf2` and `pandas`.
* **Note:** The `requirements.txt` file includes many libraries for generating downstream plots (e.g., Matplotlib, Seaborn). These are **not required** to run the core VCF processing steps defined in this pipeline but are included to reflect the full environment used during development.

### 2. Execution Notes and Performance

* This script is designed as a complete, end-to-end pipeline for VCF processing.

```bash
./DoIt.sh
```

* **Progress Tracking:** It includes numerous `echo` and `print` statements throughout its steps to provide real-time progress and status updates during execution.
* **Performance:** Processing the entire analysis (e.g., 419 samples) typically takes several hours, based on the performance observed on the training server where the script was developed.
* **Running in Background:** To ensure the pipeline runs uninterruptedly until completion, it is recommended to execute it in the background using the `nohup` command, which directs output to a log file (`DoIt.log`):

```bash
nohup ./DoIt.sh > DoIt.log 2>&1 &
```

## üìù Step-by-Step Details

### Cleanup and Setup

The script first cleans up previous results in all output directories and creates a new summary file (`variant_counts.txt`).

### Step 1: PASS Filtering

Uses `awk` with `zcat` and `bgzip` to efficiently filter the input VCF file, retaining the header and only variants where the `FILTER` column (column 7) is exactly `PASS`. 

### Step 2: LiftOver (hg19 to hg38)

Uses **GATK's `LiftoverVcf`** tool, run via Apptainer, to convert coordinates from hg19 (GRCh37) to hg38 (GRCh38). 
* **Rejected Variants:** Variants that fail the conversion are written to the `Rejected` directory.

### Step 3: VEP Annotation

Runs the **Ensembl VEP** for comprehensive annotation.
* **Configuration:** Uses `--everything`, `--offline`, and custom annotations including **SpliceAI**, **REVEL**, **ClinVar**, **CIViC**, and **CancerHotspots** databases to add functional and clinical context.

### Step 4: OncoKB Annotation

This Python script serves as the core clinical annotation engine for the pipeline. It interacts directly with the **OncoKB Precision Oncology Knowledge Base** API to enrich VEP-annotated VCF files with therapeutic, diagnostic, and prognostic information.

#### Key Features

* **Dual Annotation Modes:** Supports both tumor-specific queries (inferred from the filename) for targeted evidence and generic pan-cancer queries for broad analysis.
* **Smart Transcript Prioritization:** Implements a rigorous **3-tier selection logic** to ensure variants are annotated using the clinically relevant transcript (matching TSO500 standards), rather than just the VEP default.
* **Comprehensive Variant Handling:** Processes SNVs, Indels, and Copy Number Alterations (CNVs), with specific support for **Manta** structural variant callers (handling `MantaDUP`, `MantaDEL`, and `MantaINS` correctly).
* **Traceability:** Adds metadata fields (`GENE_EXIST`, `VARIANT_EXIST`) to explicitly track what was found in the database versus what was queried.

#### Logic and Workflow

1.  **Tumor Type Inference**
    * The script parses the input VCF filename against a predefined dictionary (`CANCER_MAP`) to detect the tumor type (e.g., "Lung", "Breast").
    * This ensures OncoKB returns evidence levels specific to that cancer context (e.g., Level 1 evidence for *EGFR* L858R in Lung Cancer vs. Level 3 in other types).
    * *Option:* Use `--tumor_mode=generic` to force a non-specific query ("UNKNOWN" tumor type) for pan-cancer evidence. Based on Oncokb documentation, generic is a better option but TODO I need to compare both results.

2.  **Variant Classification**
    * The script reads the VCF and intelligently classifies each record to determine the correct OncoKB API endpoint:
        * **Mutations (SNV/Indel/INS/BND):** Queries the `/annotate/mutations/byProteinChange` endpoint. This includes Structural Insertions (`MantaINS`) which are treated as mutations to capture protein changes (e.g., Exon 20 insertions).
        * **CNVs (DUP/DEL):** Queries the `/annotate/copyNumberAlterations` endpoint. This specifically targets Amplifications (`MantaDUP`, `GAIN`) and Deletions (`MantaDEL`, `LOSS`).

> **‚ÑπÔ∏è Technical Note: Handling Structural Insertions (`MantaINS`)**
>
> In this pipeline, **Structural Insertions** (`MantaINS`) are intentionally routed to the **Mutation** endpoint (`/annotate/mutations/byProteinChange`) rather than the Copy Number Alteration (CNV) endpoint. This is done for two critical reasons:
>
> 1.  **Clinical Biology:** Unlike simple Duplications (which increase gene dosage), Insertions often alter the internal sequence of the gene (e.g., **EGFR Exon 20 insertions**). These disruptions create specific mutant proteins that require distinct targeted therapies, which are completely different from therapies used for gene amplifications.
> 2.  **API Constraints:** The OncoKB CNV endpoint is strictly typed and **only** accepts `AMPLIFICATION`, `DELETION`, `GAIN`, or `LOSS`. It explicitly rejects `INSERTION`.
>
> By treating `MantaINS` as mutations, the pipeline leverages the Protein Change (HGVSp) calculated by VEP, ensuring that complex, actionable structural mutations are correctly identified and not misclassified as generic "amplifications."

3.  **Transcript Selection Strategy (Crucial Step)**
    To ensure the variant is annotated using the clinically relevant isoform, the script parses the VEP `CSQ` field using a **3-Tier Priority System**:
    * **Tier 1 (Preferred List):** Checks if any transcript in the VEP annotation matches a RefSeq ID (NM_*) found in `TSO500_transcripts_list.txt`. Matches are **version-agnostic** (e.g., `NM_000057.4` in the VCF will match `NM_000057` in the list).
    * **Tier 2 (MANE Select):** If no Tier 1 match is found, it searches for the transcript tagged as **MANE Select** or **MANE Plus Clinical** by Ensembl/NCBI.
    * **Tier 3 (Fallback):** If neither is found, it defaults to the first transcript reported by VEP.

4.  **API Query & Annotation**
    * Constructs a query using the Gene Symbol, Protein Change (converted to 1-letter code, e.g., `P2053L`), and Tumor Type.
    * The JSON response from OncoKB is flattened and written back into the VCF as new `INFO` fields.


### Step 5: VCF2table

This script performs the final step of the pipeline: parsing the fully annotated VCF file and converting it into a structured, analysis-ready CSV table.

Crucially, it implements the **exact same 3-Tier Transcript Selection Logic** as the OncoKB annotator (`oncokb2.0.py`). This ensures data consistency: the transcript displayed in your final table is guaranteed to be the same transcript used to query OncoKB for clinical evidence.

#### Key Features

* **Consistent Prioritization:** Uses the hierarchy `Preferred List > MANE Select > MANE Plus Clinical > Fallback` to extract the most relevant VEP annotation for every variant.
* **Version-Agnostic Matching:** Safely handles RefSeq IDs by stripping version numbers (e.g., matching `NM_004958.4` in the VCF to `NM_004958` in your list).
* **Customizable Columns:** Allows you to define exactly which VEP fields and OncoKB INFO tags appear in the output via external configuration files.
* **Robust Parsing:** Handles complex VEP `CSQ` strings and multi-allelic variants correctly.

#### Logic and Workflow

1.  **Configuration Loading**
    * Reads the list of desired VEP fields from `--vep-fields` (must match the VCF header order).
    * Reads the list of OncoKB tags from `--oncokb-fields`.
    * Loads the preferred transcript list (`--transcripts`), stripping any version numbers to ensure robust matching.

2.  **Variant Iteration**
    * Reads the input VCF line by line.
    * Extracts global `INFO` tags (like OncoKB results) which apply to the variant as a whole.
    * Parses the `CSQ` (Consequence) string, which contains annotations for multiple transcripts.

3.  **Transcript Selection (The Core Logic)**
    For each variant, the script evaluates all available transcript annotations using the following priority:
    * **Tier 1 (Preferred):** Does the annotation contain an NM ID (in `MANE_SELECT`, `MANE_PLUS_CLINICAL`, or `HGVSc`) that matches your `TSO500` list?
    * **Tier 2 (MANE Select):** If not, is it tagged as the *MANE Plus Clinical* transcript?
    * **Tier 3 (MANE Plus Clinical):** If not, is it tagged as *MANE Select*?
    * **Tier 4 (Fallback):** If none of the above, use the first annotation provided by VEP (default behavior).

4.  **Output Generation**
    * Combines the standard VCF columns (`CHROM`, `POS`, `REF`, `ALT`), the selected transcript ID (`NM_Transcript`), the selection method used (for QC), the specific VEP annotation fields for that transcript, and the OncoKB data.
    * Writes this combined record to the CSV file.

‚ùå ***I have left an example of one table in the the folder Output_Results***

## üìù TODO List
- [ ] End to end analysis over the 420 samples again and check we dont miss variants. 
- [ ] Check what variants are rejected by liftover. We shouldn't reject many as all our variants in this step are PASS only.
- [ ] Repeat the analysis twice (generic vs. tumour type) anc check what shows better annotation
- [ ] Validation/test. I need to create a very small VCF with variants that shows all annotation in OncoKB. In a preliminar view, all variants are unkonwn. I need the final table to see is there is non-unknown variants or test with kown variants in a sitetic VCF and see what is going on. For instance I dont know the decistion taken to Handling Structural Insertions is correct. 

### How results look like 

| CHROM | POS       | REF                     | ALT   | NM_Transcript | Allele    | Consequence                                                                   | IMPACT   | SYMBOL | Gene            | Feature_type | Feature         | BIOTYPE        | EXON  | INTRON | HGVSc                            | HGVSp                                | cDNA_position | CDS_position | Protein_position | Amino_acids | Codons                      | Existing_variation | DISTANCE | STRAND   | FLAGS | VARIANT_CLASS | SYMBOL_SOURCE | HGNC_ID     | CANONICAL   | MANE        | MANE_SELECT    | MANE_PLUS_CLINICAL | TSL             | APPRIS          | CCDS            | ENSP          | SWISSPROT     | TREMBL   | UNIPARC | UNIPROT_ISOFORM                           | SOURCE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | GENE_PHENO | SIFT | PolyPhen | DOMAINS | miRNA | HGVS_OFFSET | AF | AFR_AF | AMR_AF | EAS_AF | EUR_AF   | SAS_AF | gnomADe_AF | gnomADe_AFR_AF | gnomADe_AMR_AF | gnomADe_ASJ_AF | gnomADe_EAS_AF | gnomADe_FIN_AF | gnomADe_MID_AF | gnomADe_NFE_AF | gnomADe_REMAINING_AF | gnomADe_SAS_AF | gnomADg_AF                                                                                                        | gnomADg_AFR_AF | gnomADg_AMI_AF | gnomADg_AMR_AF | gnomADg_ASJ_AF | gnomADg_EAS_AF | gnomADg_FIN_AF | gnomADg_MID_AF | gnomADg_NFE_AF | gnomADg_REMAINING_AF | gnomADg_SAS_AF | MAX_AF     | MAX_AF_POPS | CLIN_SIG | SOMATIC | PHENO | PUBMED | MOTIF_NAME | MOTIF_POS | HIGH_INF_POS | MOTIF_SCORE_CHANGE | TRANSCRIPTION_FACTORS | SpliceAI_cutoff | SpliceAI_pred_DP_AG | SpliceAI_pred_DP_AL | SpliceAI_pred_DP_DG | SpliceAI_pred_DP_DL | SpliceAI_pred_DS_AG | SpliceAI_pred_DS_AL | SpliceAI_pred_DS_DG                 | SpliceAI_pred_DS_DL | SpliceAI_pred_SYMBOL | REVEL                          | ClinVar                    | ClinVar_CLNSIG                                                                                                            | ClinVar_CLNREVSTAT                                                                                                                                       | ClinVar_CLNDN                                                                                                                                | CIViC | CIViC_GN   | CIViC_VT | CIViC_CSQ | CancerHotspots | CancerHotspots_HOTSPOT | CancerHotspots_HOTSPOT_GENE | CancerHotspots_HOTSPOT_HGVS | ONCOKB_ONCOGENIC | ONCOKB_HOTSPOT          | ONCOKB_VUS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | ONCOKB_EFFECT                                                                                                                | ONCOKB_EFFECT_DESC                                                                                                                                            | ONCOKB_SENS_LVL                                                                                                                                   | ONCOKB_RESIST_LVL | ONCOKB_DIAG_LVL | ONCOKB_PROG_LVL | ONCOKB_TREATMENTS | ONCOKB_GENE_SUMMARY | ONCOKB_VARIANT_SUMMARY | ONCOKB_TUMOR_TYPE_SUMMARY | ONCOKB_DIAG_SUMMARY | ONCOKB_PROG_SUMMARY | ONCOKB_DATA_VERSION | ONCOKB_LAST_UPDATE |
| ----- | --------- | ----------------------- | ----- | ------------- | --------- | ----------------------------------------------------------------------------- | -------- | ------ | --------------- | ------------ | --------------- | -------------- | ----- | ------ | -------------------------------- | ------------------------------------ | ------------- | ------------ | ---------------- | ----------- | --------------------------- | ------------------ | -------- | -------- | ----- | ------------- | ------------- | ----------- | ----------- | ----------- | -------------- | ------------------ | --------------- | --------------- | --------------- | ------------- | ------------- | -------- | ------- | ----------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------- | ---- | -------- | ------- | ----- | ----------- | -- | ------ | ------ | ------ | -------- | ------ | ---------- | -------------- | -------------- | -------------- | -------------- | -------------- | -------------- | -------------- | -------------------- | -------------- | ----------------------------------------------------------------------------------------------------------------- | -------------- | -------------- | -------------- | -------------- | -------------- | -------------- | -------------- | -------------- | -------------------- | -------------- | ---------- | ----------- | -------- | ------- | ----- | ------ | ---------- | --------- | ------------ | ------------------ | --------------------- | --------------- | ------------------- | ------------------- | ------------------- | ------------------- | ------------------- | ------------------- | ----------------------------------- | ------------------- | -------------------- | ------------------------------ | -------------------------- | ------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------- | ----- | ---------- | -------- | --------- | -------------- | ---------------------- | --------------------------- | --------------------------- | ---------------- | ----------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------- | --------------- | --------------- | ----------------- | ------------------- | ---------------------- | ------------------------- | ------------------- | ------------------- | ------------------- | ------------------ |
| chr13 | 113232110 | C                       | <INS> | NM_001008895  | insertion | intron_variant                                                                | MODIFIER | CUL4A  | ENSG00000139842 | Transcript   | ENST00000375440 | protein_coding |       | 43586  |                                  |                                      |               |              |                  |             |                             |                    |          | 1        |       | insertion     | HGNC          | HGNC:2554   | YES         | MANE_Select | NM_001008895.4 | 1                  | P1              | CCDS41908.1     | ENSP00000364589 | Q13619.210    | UPI000021C449 | Q13619-1 |         |                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |            |      |          |         |       |             |    |        |        |        |          |        |            |                |                |                |                |                |                |                |                      |                |                                                                                                                   |                |                |                |                |                |                |                |                |                      |                |            |             |          |         |       |        |            |           |              |                    |                       |                 |                     |                     |                     |                     |                     |                     |                                     |                     |                      |                                |                            |                                                                                                                           |                                                                                                                                                          |                                                                                                                                              |       |            |          |           |                |                        | Likely Oncogenic            | FALSE                       | FALSE            | Likely Gain-of-function | Amplification of CUL4 typically results in the overexpression of the protein. CUL4 amplification has been identified in lung cancer, prostate cancer, breast cancer and ovarian cancer (PMID: 34119472, 22422151, 24305877). In vitro studies with H460, A549, LNCAP, C4-2, CWR22, 22RV1, MCF10A and MDA-MB-468 cells overexpressing CUL4 demonstrate that amplification is activating as measured by increased cellular proliferation, induced epithelial-mesenchymal transition and malignant cellular transformation compared to vector controls (PMID: 28576144, 25413624, 28223829). Preclinical studies with ovarian cancer cells and lung cancer cells overexpressing CUL4 demonstrate resistance to cisplatin, doxorubicin, docetaxel, gemcitabine and erlotinib as measured by decreased cellular apoptosis and sustained cellular proliferation (PMID: 25413624, 26503734, 30718461). | CUL4, a ubiquitin ligase component of an E3 ubiquitin-protein ligase complex, is infrequently altered in cancer.             | CUL4A amplification is likely oncogenic.                                                                                                                      | There are no FDA-approved or NCCN-compendium listed treatments specifically for patients with CUL4A-amplified UNKNOWN.                            | v5.4              | 07/19/2023      |
| chr11 | 76446673  | A                       | <INS> | NM_001300942  | insertion | feature_elongation&coding_sequence_variant&5_prime_UTR_variant&intron_variant | HIGH     | EMSY   | ENSG00000158636 | Transcript   | ENST00000695367 | protein_coding | 44593 | 44228  |                                  |                                      |               |              |                  |             |                             |                    |          | 1        |       | insertion     | HGNC          | HGNC:18071  | YES         | MANE_Select | NM_001300942.2 |                    |                 | CCDS73349.1     | ENSP00000511840 | Q7Z589.185    | UPI000191704B | Q7Z589-7 |         |                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |            |      |          |         |       |             |    |        |        |        |          |        |            |                |                |                |                |                |                |                |                      |                |                                                                                                                   |                |                |                |                |                |                |                |                |                      |                |            |             |          |         |       |        |            |           |              |                    |                       |                 |                     |                     |                     |                     |                     |                     |                                     |                     |                      |                                |                            |                                                                                                                           |                                                                                                                                                          |                                                                                                                                              |       |            |          |           |                |                        | Likely Oncogenic            | FALSE                       | FALSE            | Likely Gain-of-function | Amplification of EMSY typically results in the overexpression of the protein. EMSY amplification has been identified in breast and ovarian cancers (PMID: 21735447, 14651845). In vitro studies with MCF-7 cells overexpressing EMSY demonstrate that amplification is activating as measured by chromosomal instability and loss of BRCA2 function compared to wildtype (PMID: 21409565).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | EMSY, a BRCA2-associated transcriptional repressor protein, is altered by amplification in breast cancer and ovarian cancer. | EMSY amplification is likely oncogenic.                                                                                                                       | There are no FDA-approved or NCCN-compendium listed treatments specifically for patients with EMSY-amplified UNKNOWN.                             | v5.4              | ########        |                 |
| chr1  | 11130772  | C                       | T     | NM_004958     | T         | stop_gained                                                                   | HIGH     | MTOR   | ENSG00000198793 | Transcript   | ENST00000361445 | protein_coding | 39/58 |        | ENST00000361445.9:c.5370G>A      | ENSP00000354558.4:p.Trp1790Ter       | 5491          | 5370         | 1790             | W/\*        | tgG/tgA                     | rs2100433455       | \-1      |          | SNV   | HGNC          | HGNC:3942     | YES         | MANE_Select | NM_004958.4 | 1              | P1                 | CCDS127.1       | ENSP00000354558 | P42345.237      | UPI000012ABD3 |               | 1        |         |                                           | PDB-ENSP_mappings:3jbz.A&PDB-ENSP_mappings:4jsn.A&PDB-ENSP_mappings:4jsn.B&PDB-ENSP_mappings:4jsp.A&PDB-ENSP_mappings:4jsp.B&PDB-ENSP_mappings:4jsv.A&PDB-ENSP_mappings:4jsv.B&PDB-ENSP_mappings:4jsx.A&PDB-ENSP_mappings:4jsx.B&PDB-ENSP_mappings:4jt5.A&PDB-ENSP_mappings:4jt5.B&PDB-ENSP_mappings:4jt6.A&PDB-ENSP_mappings:4jt6.B&PDB-ENSP_mappings:5flc.B&PDB-ENSP_mappings:5flc.F&PDB-ENSP_mappings:5h64.A&PDB-ENSP_mappings:5h64.a&PDB-ENSP_mappings:5wbu.A&PDB-ENSP_mappings:5wbu.B&PDB-ENSP_mappings:5wby.A&PDB-ENSP_mappings:5wby.B&PDB-ENSP_mappings:5zcs.A&PDB-ENSP_mappings:5zcs.B&PDB-ENSP_mappings:6bcu.A&PDB-ENSP_mappings:6bcu.B&PDB-ENSP_mappings:6bcx.A&PDB-ENSP_mappings:6bcx.B&PDB-ENSP_mappings:6sb0.A&PDB-ENSP_mappings:6sb0.B&PDB-ENSP_mappings:6sb2.A&PDB-ENSP_mappings:6sb2.B&PDB-ENSP_mappings:6zwm.A&PDB-ENSP_mappings:6zwm.B&PDB-ENSP_mappings:6zwo.B&PDB-ENSP_mappings:7owg.B&PDB-ENSP_mappings:7pe7.A&PDB-ENSP_mappings:7pe7.B&PDB-ENSP_mappings:7pe8.A&PDB-ENSP_mappings:7pe9.A&PDB-ENSP_mappings:7pea.A&PDB-ENSP_mappings:7pea.B&PDB-ENSP_mappings:7peb.A&PDB-ENSP_mappings:7pec.A&PDB-ENSP_mappings:7tzo.A&PDB-ENSP_mappings:7tzo.B&PDB-ENSP_mappings:7uxc.A&PDB-ENSP_mappings:7uxh.A&PDB-ENSP_mappings:7uxh.C&PDB-ENSP_mappings:8era.A&PDB-ENSP_mappings:9f44.A&PDB-ENSP_mappings:9f44.B&PDB-ENSP_mappings:9f45.A&PDB-ENSP_mappings:9f45.B&PROSITE_profiles:PS51189&Pfam:PF02259&Gene3D:1.25.40.10&PANTHER:PTHR11139&AFDB-ENSP_mappings:AF-P42345-F1 | 0          | 0    | 0        | 0       | 0     | 0           | 0  | 0      | 0      | 0      |          |        |            |                |                |                |                |                |                |                |                      | 0              | gnomADe_AFR&gnomADe_AMR&gnomADe_ASJ&gnomADe_EAS&gnomADe_FIN&gnomADe_MID&gnomADe_NFE&gnomADe_REMAINING&gnomADe_SAS | FAIL           | \-14           | 40             | 3              | \-14           | 0              | 0              | 0              | 0                    | MTOR           |            |             |          |         |       |        |            |           |              |                    |                       |                 |                     | Unknown             | FALSE               | FALSE               | Unknown             |                     |                                     |                     |                      |                                |                            | MTOR, an intracellular kinase that regulates cell growth and metabolism, is infrequently mutated in various cancer types. | The MTOR ENSP00000354558.4:w1790\* mutation has not specifically been reviewed by the OncoKB team, and therefore its biological significance is unknown. | There are no FDA-approved or NCCN-compendium listed treatments specifically for patients with MTOR ENSP00000354558.4:W1790\* mutant UNKNOWN. | v5.4  | 01/16/2019 |
| chr5  | 1295135   | G                       | A     | NM_198253     | A         | upstream_gene_variant                                                         | MODIFIER | TERT   | ENSG00000164362 | Transcript   | ENST00000310581 | protein_coding |       |        |                                  |                                      |               |              |                  |             |                             | rs1561215364       | 67       | \-1      |       | SNV           | HGNC          | HGNC:11730  | YES         | MANE_Select | NM_198253.3    | 1                  | P2              | CCDS3861.2      | ENSP00000309572 | O14746.211    | UPI0000031309 | O14746-1 |         | 1                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |            |      |          |         |       |             |    |        |        |        | 3.91E-05 | 0      | 0          | 0.000203       | 0              | 0              | 0              | 4.72E-05       | 0              | 0              |                      |                |                                                                                                                   |                |                |                |                |                |                |                |                | 0.000203             | gnomADe_ASJ    | pathogenic | 1           |          |         |       |        |            |           |              |                    |                       |                 |                     |                     |                     |                     |                     |                     |                                     | 2443072             | Pathogenic           | no_assertion_criteria_provided | Lung_sarcomatoid_carcinoma |                                                                                                                           |                                                                                                                                                          | chr5:1295135-1295135                                                                                                                         |       |            |          |           |                |                        |                             |                             |                  |                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                              |                                                                                                                                                               |                                                                                                                                                   |                   |                 |                 |                   |                     |
| chr19 | 35732782  | CTCGGGGCCAGGGCACGCCTCCT | C     | NM_014727     | \-        | frameshift_variant                                                            | HIGH     | KMT2B  | ENSG00000272333 | Transcript   | ENST00000420124 | protein_coding | 28/37 |        | ENST00000420124.4:c.6245_6266del | ENSP00000398837.2:p.Gly2082GlufsTer2 | 6250-6271     | 6234-6255    | 2078-2085        | PRGQGTPP/X  | ccTCGGGGCCAGGGCACGCCTCCT/cc | 1                  |          | deletion | HGNC  | HGNC:15840    | YES           | MANE_Select | NM_014727.3 | 1           | P2             | CCDS46055.1        | ENSP00000398837 | Q9UMN6.231      | UPI00001376B5   |               | 1             |          |         | PIRSF:PIRSF010354&MobiDB_lite:mobidb-lite | 11                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |            |      |          |         |       |             |    |        |        |        |          |        |            |                |                |                |                |                |                |                |                      |                |                                                                                                                   |                |                |                |                |                |                |                |                |                      |                |            |             |          |         |       |        |            |           |              |                    |                       |                 |                     |                     |                     |                     | 2710555             | Pathogenic          | criteria_provided&_single_submitter | not_provided        |                      |                                |                            |                                                                                                                           |                                                                                                                                                          |                                                                                                                                              |       | Unknown    | FALSE    | FALSE     | Unknown        |                        |                             |                             |                  |                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | KMT2B, a histone methyltransferase, is mutated at low frequencies in various cancer types.                                   | The KMT2B ENSP00000398837.2:g2082efs\*2 mutation has not specifically been reviewed by the OncoKB team, and therefore its biological significance is unknown. | There are no FDA-approved or NCCN-compendium listed treatments specifically for patients with KMT2B ENSP00000398837.2:G2082Efs\*2 mutant UNKNOWN. | v5.4              | 11/25/2019      |


## Where the data in the ArchiveData server is
```bash
/mnt/ArchiveData/results/TSO500_WESSEX
‚îú‚îÄ‚îÄ excel_and_other_files_provided   # Documents and other files shared by the team or Birmingham Bioinformatics
‚îú‚îÄ‚îÄ raw                              # Raw sequencing data
‚îÇ   ‚îî‚îÄ‚îÄ files                        # All TSO500 FASTQ (.ora) files
‚îú‚îÄ‚îÄ README.md                        # Documentation explaining how the data are organised
‚îú‚îÄ‚îÄ scripts                          # Scripts for data integrity checks and TSO500 sample grouping
‚îî‚îÄ‚îÄ VCFs                             # Variant Call Format (VCF) files
    ‚îî‚îÄ‚îÄ files                        # All TSO500 VCF files
        ‚îî‚îÄ‚îÄ AnnotatedVEP             # 418 PASS, liftover-processed, and VEP-annotated TSO500 VCFs file + DoIt.log (log file showing liftover and VEP analysis records )
```bash

